<%
  # Generate proper URL for PDF viewing with inline disposition
  pdf_url = url_for(blob)
%>
<div class="relative inline-block w-full">
  <!-- PDF.js viewer container -->
  <div data-controller="pdf-viewer"
       data-pdf-viewer-url-value="<%= pdf_url %>"
       data-pdf-viewer-copyrighted-value="<%= is_copyrighted %>"
       class="bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-600 overflow-auto"
       style="max-height: 800px; <%= is_copyrighted ? 'user-select: none;' : '' %>">
    <!-- PDF pages will be rendered here as canvas elements -->
  </div>
</div>
<% if is_copyrighted %>
  <div class="mt-3 p-3 bg-amber-50 border border-amber-200">
    <div class="flex justify-between items-start gap-2">
      <p class="text-sm font-medium text-amber-800">Copyrighted Material</p>
      <% if purchase_url.present? %>
        <p class="text-sm text-amber-700 mt-1">
          Purchase:
          <%= link_to "Click Here", purchase_url,
                target: "_blank",
                rel: "noopener noreferrer",
                class: "text-blue-600 hover:text-blue-800 underline font-medium" %>
        </p>
      <% end %>
    </div>
  </div>
<% else %>
  <div class="mt-3 p-3 bg-amber-50 border border-amber-200">
    <div class="flex justify-between items-start gap-2">
      <p class="text-sm font-medium text-amber-800">Non Copyrighted Material</p>
      <p class="text-sm text-amber-700 mt-1">
        Download:
        <%= link_to "Click Here", rails_blob_path(blob, disposition: "attachment"),
                target: "_blank",
                rel: "noopener noreferrer",
                class: "text-blue-600 hover:text-blue-800 underline font-medium" %>
      </p>
    </div>
  </div>
<% end %>