<div id="<%= dom_id @episode %>" class="" style="max-width: 640px; ">
  <% if @episode.lesson_video.attached? %>
    <div style="aspect-ratio: 4/3;">
      <div class=" w-full relative bg-black" style="max-width: 640px; aspect-ratio: 4/3;" data-controller="video-poster">
        <%= video_tag @episode.lesson_video, id: "lesson-video", style: "width: 100%; height: 100%; object-fit: contain;", controls: true, autoplay: true, preload: "metadata", data: {
              video_poster_target: "video",
              controller: "video-autoplay",
              video_autoplay_next_url_value: (@episode.next_lesson ? project_episode_path(@episode.project, @episode.next_lesson) : nil),
              video_autoplay_next_name_value: @episode.next_lesson&.name,
              video_autoplay_next_date_value: @episode.next_lesson&.date&.strftime("%B %d, %Y")
            } %>
        <div data-video-poster-target="overlay" class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none bg-black">
          <h2 class="text-white text-3xl font-bold text-center px-8"><%= @episode.name %></h2>
          <p class="text-gray-400 text-xl mt-4"><%= @episode.date.strftime("%B %d, %Y") %></p>
        </div>
      </div>
    </div>
  <% end %>
  <div class="bg-gray-800 p-4 text-white" data-controller="pdf-toggle">
    <%# Tailwind classes used in JS controller %>
    <div class="hidden text-blue-400 hover:text-blue-300 underline font-medium transition-colors"></div>
    <div class="flex justify-between items-center mb-2">
      <h3 class="text-lg font-semibold">Lesson Notes and Music</h3>
      <p class="dark:text-slate-300 text-sm sm:text-base">
        <strong class="font-semibold text-white">Teacher:</strong>
        <%= link_to @episode.teacher.name, professor_path(@episode.teacher), class:'text-indigo-300 hover:text-indigo-200' %>
      </p>
    </div>
    <div class="mt-4">
      <%= render 'chapter_list', episode: @episode %>
    </div>
    <%= @episode.description %>
    <%= render 'shared/share_buttons' %>
    <div class="xl:hidden mt-5">
      <%= render '/public/projects/episode_dropdown', episode: @episode, project: @episode.project %>
    </div>
  </div>
</div>